{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { catchError, throwError } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/api/spectrum-airdrop.service\";\nimport * as i2 from \"../../services/terrajs.service\";\nimport * as i3 from \"@angular/common/http\";\nimport * as i4 from \"../../services/modal.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"../../pipes/timeago.pipe\";\nimport * as i8 from \"../../pipes/unit.pipe\";\nfunction AirdropComponent_span_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"date\");\n    i0.ɵɵpipe(3, \"timeago\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"Claim deadline at: \", i0.ɵɵpipeBind2(2, 2, ctx_r0.configResponse.to_timestamp * 1000, \"long\"), \" ( \", i0.ɵɵpipeBind1(3, 5, ctx_r0.configResponse.to_timestamp * 1000), \" )\");\n  }\n}\nfunction AirdropComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.searchAddress, \" is not eligible for an airdrop. \");\n  }\n}\nfunction AirdropComponent_div_19_div_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19);\n    i0.ɵɵelement(1, \"span\", 20);\n    i0.ɵɵtext(2, \"\\u00A0Loading... \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AirdropComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 13)(2, \"span\", 14);\n    i0.ɵɵtext(3, \"At Terra Classic block 7790000, you had\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 15)(5, \"div\");\n    i0.ɵɵtext(6, \"SPEC in your wallet\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 16);\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"unit\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"div\", 15)(11, \"div\");\n    i0.ɵɵtext(12, \"SPEC in gov\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 16);\n    i0.ɵɵtext(14);\n    i0.ɵɵpipe(15, \"unit\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"div\", 15)(17, \"div\");\n    i0.ɵɵtext(18, \"SPEC-UST LP in your wallet\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"div\", 16);\n    i0.ɵɵtext(20);\n    i0.ɵɵpipe(21, \"unit\");\n    i0.ɵɵpipe(22, \"unit\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(23, \"div\", 15)(24, \"div\");\n    i0.ɵɵtext(25, \"SPEC-UST LP in farm\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"div\", 16);\n    i0.ɵɵtext(27);\n    i0.ɵɵpipe(28, \"unit\");\n    i0.ɵɵpipe(29, \"unit\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(30, \"div\", 17);\n    i0.ɵɵelement(31, \"br\");\n    i0.ɵɵelementStart(32, \"div\", 1);\n    i0.ɵɵtext(33);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"div\", 1);\n    i0.ɵɵtext(35);\n    i0.ɵɵpipe(36, \"unit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(37, \"br\");\n    i0.ɵɵelementStart(38, \"div\", 1);\n    i0.ɵɵtext(39, \"Airdrop claim will be available upon SPEC 2.0 token launch\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(40, AirdropComponent_div_19_div_40_Template, 3, 0, \"div\", 18);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(9, 10, ctx_r3.userAirdropDetail.post_spec));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(15, 12, ctx_r3.userAirdropDetail.post_gov));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind1(21, 14, ctx_r3.userAirdropDetail.post_lp), \" (\", i0.ɵɵpipeBind1(22, 16, +ctx_r3.userAirdropDetail.post_lp * ctx_r3.POSTDEPEG_LP_RATIO), \" SPEC)\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind1(28, 18, ctx_r3.userAirdropDetail.post_vault), \" (\", i0.ɵɵpipeBind1(29, 20, +ctx_r3.userAirdropDetail.post_vault * ctx_r3.POSTDEPEG_LP_RATIO), \" SPEC)\");\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"1 SPEC at snapshot block can claim \", ctx_r3.ONE_POSTDEPEG_CAN_CLAIM, \" SPEC 2.0 airdrop\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r3.userAirdropDetail.address, \" is eligible for \", i0.ɵɵpipeBind1(36, 22, ctx_r3.sumAirdropAmount(ctx_r3.userAirdropDetail)), \" SPEC 2.0 airdrop\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.loading);\n  }\n}\nexport let AirdropComponent = /*#__PURE__*/(() => {\n  class AirdropComponent {\n    constructor(airdropService, terrajs, httpClient, modal) {\n      this.airdropService = airdropService;\n      this.terrajs = terrajs;\n      this.httpClient = httpClient;\n      this.modal = modal;\n      this.configResponse = null;\n      this.POSTDEPEG_LP_RATIO = 417115488643 / 926892707624;\n      this.ONE_POSTDEPEG_CAN_CLAIM = 1;\n      this.claimedAll = false;\n      this.loading = false;\n      this.notFound = false;\n    }\n    get claimPeriodEnded() {\n      var _a;\n      return ((_a = this.configResponse) === null || _a === void 0 ? void 0 : _a.to_timestamp) > Date.now();\n    }\n    ngOnInit() {\n      if (this.terrajs.isConnected) {\n        this.airdropInputAddress = this.terrajs.address;\n      } else {\n        this.connected = this.terrajs.connected.subscribe(isConnected => __awaiter(this, void 0, void 0, function* () {\n          if (isConnected && this.terrajs.address) {\n            this.airdropInputAddress = this.terrajs.address;\n          }\n        }));\n      }\n    }\n    checkAirdrop() {\n      if (this.airdropInputAddress.trim().length !== 44) {\n        return;\n      }\n      this.loading = true;\n      this.searchAddress = this.airdropInputAddress.trim();\n      const jsonUrl = `${window.location.origin}/assets/airdrop/${this.searchAddress.charAt(6)}_airdrop.json`;\n      this.httpClient.get(jsonUrl).pipe(catchError(error => {\n        console.error(error);\n        this.userAirdropDetail = null;\n        this.loading = false;\n        this.notFound = true;\n        return throwError(() => new Error('Unable to load airdrop json'));\n      })).subscribe(airdropJson => {\n        const userAirdropDetail = airdropJson.find(record => record.address === this.searchAddress);\n        if (userAirdropDetail) {\n          this.userAirdropDetail = userAirdropDetail;\n          this.loading = false;\n          this.notFound = false;\n        } else {\n          this.userAirdropDetail = null;\n          this.loading = false;\n          this.notFound = true;\n        }\n      });\n    }\n    claim() {\n      return __awaiter(this, void 0, void 0, function* () {\n        if (this.terrajs.address !== this.userAirdropDetail.address) {\n          yield this.modal.alert('Connected wallet address must be the same as input address');\n        } else {\n          yield this.airdropService.handle({\n            claim: {\n              claim_amount: this.userAirdropDetail.amount,\n              merkle_proof: this.userAirdropDetail.merkle_proof,\n              root_index: this.userAirdropDetail.index\n            }\n          });\n        }\n      });\n    }\n    sumAirdropAmount(userAirdropDetail) {\n      return +userAirdropDetail.post_spec + +userAirdropDetail.post_gov + +userAirdropDetail.post_lp * this.POSTDEPEG_LP_RATIO + +userAirdropDetail.post_vault * this.POSTDEPEG_LP_RATIO;\n    }\n  }\n  AirdropComponent.ɵfac = function AirdropComponent_Factory(t) {\n    return new (t || AirdropComponent)(i0.ɵɵdirectiveInject(i1.SpectrumAirdropService), i0.ɵɵdirectiveInject(i2.TerrajsService), i0.ɵɵdirectiveInject(i3.HttpClient), i0.ɵɵdirectiveInject(i4.ModalService));\n  };\n  AirdropComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AirdropComponent,\n    selectors: [[\"app-airdrop\"]],\n    decls: 20,\n    vars: 4,\n    consts: [[1, \"container\", \"py-5\"], [1, \"row\"], [1, \"col-12\"], [1, \"sub-topic\"], [1, \"row\", \"pt-3\"], [1, \"card\", \"spec-form\", \"bg-gray\"], [1, \"card-body\"], [1, \"mt-3\", \"mb-4\"], [4, \"ngIf\"], [1, \"input-group\", \"mb-2\"], [\"name\", \"airdropAddressInputCtl\", \"required\", \"\", 1, \"form-control\", \"fix-border\", 3, \"ngModel\", \"ngModelChange\"], [\"airdropAddressInput\", \"ngModel\"], [\"type\", \"button\", 1, \"btn\", \"btn-max\", \"last\", 3, \"click\"], [1, \"card-grey\", \"p-3\"], [1, \"mb-1\", \"mt-2\"], [1, \"d-flex\"], [1, \"margin-left-auto\"], [1, \"container\"], [\"class\", \"d-flex align-items-center justify-content-center pt-3\", 4, \"ngIf\"], [1, \"d-flex\", \"align-items-center\", \"justify-content-center\", \"pt-3\"], [\"aria-hidden\", \"true\", \"role\", \"status\", 1, \"spinner-grow\", \"spinner-grow-sm\"]],\n    template: function AirdropComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\")(1, \"div\", 0)(2, \"div\", 1)(3, \"div\", 2)(4, \"h4\");\n        i0.ɵɵtext(5, \"SPEC 2.0 Airdrop\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"span\", 3);\n        i0.ɵɵtext(7, \"Enter your address to check the amount of eligible token airdrop. Please note that SPEC token will be available at later date.\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(8, \"div\", 4)(9, \"div\", 5)(10, \"div\", 6)(11, \"div\", 7);\n        i0.ɵɵtemplate(12, AirdropComponent_span_12_Template, 4, 7, \"span\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"div\", 9)(14, \"input\", 10, 11);\n        i0.ɵɵlistener(\"ngModelChange\", function AirdropComponent_Template_input_ngModelChange_14_listener($event) {\n          return ctx.airdropInputAddress = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"button\", 12);\n        i0.ɵɵlistener(\"click\", function AirdropComponent_Template_button_click_16_listener() {\n          return ctx.checkAirdrop();\n        });\n        i0.ɵɵtext(17, \" Check \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(18, AirdropComponent_div_18_Template, 2, 1, \"div\", 8);\n        i0.ɵɵtemplate(19, AirdropComponent_div_19_Template, 41, 24, \"div\", 8);\n        i0.ɵɵelementEnd()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(12);\n        i0.ɵɵproperty(\"ngIf\", ctx.configResponse == null ? null : ctx.configResponse.to_timestamp);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.airdropInputAddress);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.notFound);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.userAirdropDetail);\n      }\n    },\n    dependencies: [i5.NgIf, i6.DefaultValueAccessor, i6.NgControlStatus, i6.RequiredValidator, i6.NgModel, i5.DatePipe, i7.TimeagoPipe, i8.UnitPipe]\n  });\n  return AirdropComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}